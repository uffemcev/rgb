## Описание
Скрипт автоматизирует переключение подсветки во время простоя ПК через планировщик заданий. Поддерживается OpenRGB и SignalRGB. По умолчанию включается белая подсветка при обычной работе и черная подсветка при простое. Работоспособность скрипта проверена на Windows 11 22H2. Скрипту требуются права администратора для работы с реестром и планировщиком.

Принимаются замечания, предложения и вопросы!

## Запуск
Онлайн установка скрипта с настройками по умолчанию:
```
powershell -ExecutionPolicy Bypass "& ([ScriptBlock]::Create((irm raw.githubusercontent.com/uffemcev/rgb/main/rgb.ps1)))"
```
Если настройки по умолчанию не устраивают, можно изменить скрипт и запустить его с ПК:
```
powershell -ExecutionPolicy Bypass ".\rgb.ps1"
```
По завершению работы файл можно удалить.

## Принцип работы
Скрипт предлагает выбрать exe файл OpenRGB или SignalRGB для записи путей, если до этого файл не был найден в директории скрипта.

Заданное в скрипте время регулирует момент, когда включатся следующие опции:
* Начинать с экрана входа в систему через $time
* При питании от сети отключать мой экран через $time

Этот автоматический триггер используется в планировщике:
* Задание RGB_off с триггером блокирования ПК для выключения подсветки
* Задание RGB_on c триггером разблокирования ПК для включения подсветки

ПК автоматически переходит на экран входа через заданное время, монитор выключается и активируется задание RGB_off. По возвращению на рабочий стол активируется задание RGB_on.

## Дополнительно
* При разблокировании ПК на мгновение будет появляться консольное окно - это нормальное поведение планировщика заданий
* По умолчанию, сочетание клавиш WIN + L блокирует рабочую станцию, поэтому подсветка так же выключится
* Не стоит устанавливать время слишком низким, рекомендованный минимум - 300 секунд
* Из-за особенностей Windows монитор и подсветка не всегда гаснут ровно через заданное время, иногда необходимо подождать чуть дольше

## Ссылки
* [SignalRGB Wiki](https://docs.signalrgb.com/application-url-s)
* [OpenRGB Wiki](https://openrgb-wiki.readthedocs.io/en/latest/Frequently-Asked-Questions)
